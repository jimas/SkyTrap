<!DOCTYPE html SYSTEM "http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-spring4-3.dtd">
<html lang="zh-CN" class="no-js" xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org">
<head>
<title>task list</title>
<div th:include="common/drop/dropcss :: dropcss" th:remove="tag" />

<style type="text/css">
	th{
		text-align:center;
	}
</style>
</head>
<body th:with="headTitle='城市列表'">
	<div th:replace="common/header :: header" th:remove="tag" />
	<table class="table table-hover table-bordered">
			<thead>
				<tr>
					<th>id</th>
					<th>cname</th>
					<th>upid</th>
				</tr>
			</thead>
			<tbody class="citylist">
			</tbody>
		</table>
	
	
	<div th:include="common/drop/dropjs :: dropjs" th:remove="tag" />

	<script th:inline="javascript">
	
	$('.citylist').dropload({
	    scrollArea : window,
	    loadDownFn : function(me){
	        $.ajax({
	            type: 'GET',
	            url: [[@{/}]]+'static/json/areas.json',
	            dataType: 'json',
	            success: function(data){
	                // 每次数据加载完，必须重置
				 var str="";
				 $.each(data,function(index,item){
					 str=str+"<tr>";
					 str=str+"<td>"+data[index].id+"</td>";
					 str=str+"<td>"+data[index].cname+"</td>";
					 str=str+"<td>"+data[index].upid+"</td>";
					 str=str+"</tr>";
				 })
				 
				 $('.citylist').html(str);
	                me.resetload();
	            },
	            error: function(xhr, type){
	                alert('Ajax error!');
	                // 即使加载出错，也得重置
	                me.resetload();
	            }
	        });
	    }
	});
	    
	</script>
		
</body>

</html>